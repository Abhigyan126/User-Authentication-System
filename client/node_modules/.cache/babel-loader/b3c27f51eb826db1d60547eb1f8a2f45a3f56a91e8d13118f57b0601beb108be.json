{"ast":null,"code":"import React,{useEffect,useState}from'react';import jwt from'jsonwebtoken';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Dashboard=()=>{const navigate=useNavigate();const[quote,setQuote]=useState('');const[tempQuote,setTempQuote]=useState('');const[userInfo,setUserInfo]=useState({username:'',email:''});const fetchQuote=async()=>{try{const response=await fetch('http://localhost:1337/api/quote',{headers:{'X-access-token':localStorage.getItem('token')}});const data=await response.json();if(data.status==='ok'){setQuote(data.quote);}else{alert(data.error);}}catch(error){alert('Error fetching quote');}};useEffect(()=>{const token=localStorage.getItem('token');if(token){const user=jwt.decode(token);if(!user){localStorage.removeItem('token');navigate('/login');}else{setUserInfo({username:user.Name,email:user.email});fetchQuote();}}else{navigate('/login');}},[navigate]);const handleLogout=()=>{localStorage.removeItem('token');navigate('/login');};const handleQuoteUpdate=async e=>{e.preventDefault();try{const response=await fetch('http://localhost:1337/api/quote',{method:'POST',headers:{'Content-Type':'application/json','X-access-token':localStorage.getItem('token')},body:JSON.stringify({quote:tempQuote})});const data=await response.json();if(data.status==='ok'){setQuote(tempQuote);setTempQuote('');}else{alert(data.error);}}catch(error){alert('Error updating quote');}};return/*#__PURE__*/_jsxs(\"div\",{className:\"form-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"rectangle\"}),/*#__PURE__*/_jsxs(\"h3\",{children:[\"Welcome, \",userInfo.username||'User']}),/*#__PURE__*/_jsxs(\"h4\",{children:[\"Email: \",userInfo.email||'Email not available']}),/*#__PURE__*/_jsxs(\"h3\",{children:[\"Your quote: \",quote||'No quote found']}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleQuoteUpdate,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Quote\",value:tempQuote,onChange:e=>setTempQuote(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Update quote\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleLogout,children:\"Logout\"})]})]});};export default Dashboard;","map":{"version":3,"names":["React","useEffect","useState","jwt","useNavigate","jsx","_jsx","jsxs","_jsxs","Dashboard","navigate","quote","setQuote","tempQuote","setTempQuote","userInfo","setUserInfo","username","email","fetchQuote","response","fetch","headers","localStorage","getItem","data","json","status","alert","error","token","user","decode","removeItem","Name","handleLogout","handleQuoteUpdate","e","preventDefault","method","body","JSON","stringify","className","children","onSubmit","type","placeholder","value","onChange","target","onClick"],"sources":["/Users/abhigyan/Documents/mern/client/src/pages/quote.js"],"sourcesContent":["import React, { useEffect, useState } from 'react'\nimport jwt from 'jsonwebtoken'\nimport { useNavigate } from 'react-router-dom'\n\nconst Dashboard = () => {\n    const navigate = useNavigate()\n    const [quote, setQuote] = useState('')\n    const [tempQuote, setTempQuote] = useState('')\n    const [userInfo, setUserInfo] = useState({ username: '', email: '' })\n    \n    const fetchQuote = async () => {\n        try {\n            const response = await fetch('http://localhost:1337/api/quote', {\n                headers: {\n                    'X-access-token': localStorage.getItem('token'),\n                },\n            })\n\n            const data = await response.json()\n            if (data.status === 'ok') {\n                setQuote(data.quote)\n            } else {\n                alert(data.error)\n            }\n        } catch (error) {\n            alert('Error fetching quote')\n        }\n    }\n\n    useEffect(() => {\n        const token = localStorage.getItem('token')\n        if (token) {\n            const user = jwt.decode(token)\n            if (!user) {\n                localStorage.removeItem('token')\n                navigate('/login')\n            } else {\n                setUserInfo({ username: user.Name, email: user.email })\n                fetchQuote()\n            }\n        } else {\n            navigate('/login')\n        }\n    }, [navigate])\n\n    const handleLogout = () => {\n        localStorage.removeItem('token')\n        navigate('/login')\n    }\n\n    const handleQuoteUpdate = async (e) => {\n        e.preventDefault()\n        try {\n            const response = await fetch('http://localhost:1337/api/quote', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'X-access-token': localStorage.getItem('token'),\n                },\n                body: JSON.stringify({ quote: tempQuote }),\n            })\n\n            const data = await response.json()\n            if (data.status === 'ok') {\n                setQuote(tempQuote)\n                setTempQuote('')\n            } else {\n                alert(data.error)\n            }\n        } catch (error) {\n            alert('Error updating quote')\n        }\n    }\n\n    return (\n        <div className=\"form-container\">\n            <div className=\"rectangle\"></div>\n            <h3>Welcome, {userInfo.username || 'User'}</h3>\n            <h4>Email: {userInfo.email || 'Email not available'}</h4>\n            <h3>Your quote: {quote || 'No quote found'}</h3>\n            <form onSubmit={handleQuoteUpdate}>\n                <input\n                    type='text'\n                    placeholder='Quote'\n                    value={tempQuote}\n                    onChange={e => setTempQuote(e.target.value)}\n                />\n                <input type='submit' value='Update quote' />\n                <button type='button' onClick={handleLogout}>Logout</button>\n            </form>\n        </div>\n    )\n}\n\nexport default Dashboard\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}